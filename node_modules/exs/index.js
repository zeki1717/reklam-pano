var http = require('http');
var ws = require('ws');
var fs = require('fs');

module.exports.createServer = function(app, callback) {
    app.get('/exs', function(req, res) {
        res.writeHead(200, {'Content-Type': 'text/plain'});
        res.end('Welcome to EXS');
    });
    
    app.get('/exs/socket.js', function(req, res) {
        res.sendfile(__dirname + '/client.js');
    })
    
    var options = {
        server: http.createServer(app),
        path: '/exs'
    }
    
    var socket = new ws.createServer(options, callback);
    
    Object.defineProperty(socket, "listen", { value: function(port, host) { this._server.listen(port, host); } });
    
    return socket;
}